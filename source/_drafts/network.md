---
title: network
date: 2021-04-07 21:21:21
tags: network
toc: true
declare: true
categories:
  - 计算机网络原理
# keywords: 博客文章密码
# password: dnhyxc
# abstract: 该博文可能涉及技术泄密及收费内容，如需查看请与我联系获取访问密码
---

### 计算机网络基本概念

#### 计算机网络的定义

1，计算机网络使利用`通信设备`与`通信链路`或者`通信网络`，互连位置不同，`功能自治的计算机系统`，并遵循一定的规则实现计算机系统之间信息交换。

2，简短概括为：计算机网络是互联的，自治的计算机的集合。

- **自治**：是指互联的计算机系统彼此独立，不存在主或从或者控制与被控制的关系。

- **互联**：是指利用通信链路连接相互独立的计算机系统。

<!-- more -->

#### 协议的定义

1，通过通信链路互联主机与网络设备是构建计算机网络的硬件基础，但仅仅实现了网络硬件设备的互联，还不足以确保通行实体间进行正常的数据交换。就比如搭建好了公路网，但是要保证正常通行，还必须要规定交通规则及红路灯，指示牌等设备。而在路上的行驶的汽车必须遵守这个规则。

2，计算机网络中的实体在进行数据交换的过程中也必须遵循一些规则或约定，这些规则或约定就是`网络协议`。

3，协议约定了实体之间交换的信息类型，信息各部分的含义、信息交换顺序以及收到特定信息或者出现异常时应采取的行为。

4，任何一个协议都会显示或隐式的定义三个基本要素：语法、语义和时序，称为三要素。

- **语法**：语法定义实体之间交换信息的格式与结构，或者定义实体（比如硬件设备）之间传输信号的电平等。

- **语义**：实体之间交换的信息，除了协议用户需要传输的数据之外，通常还包括其它控制信息，比如地址信息等。语义就是定义实体之间交换的信息中需要发送（或包含）哪些控制信息，这些信息的具体含义，以及针对不同含义的控制信息，接收信息端应如何响应。另外有的协议还需要进行差错检测，这类协议通常会在协议信息中附加差错编码等控制信息。语义还需要定义彼此采用何种差错编码，以及采用何种差错处理机制等。

- **时序**：时序也成为同步，定义实体之间交换信息的时序以及如何匹配或适应彼此的速度。

#### 计算机网络的功能

1，计算机网络的`功能就是在不同主机之间实现快速的信息交换`。通过信息交换，计算机网络可实现资源共享这一核心功能，包括`硬件资源共享`，`软件资源共享`和`信息资源共享`。

- **硬件资源共享**：通过计算机网络，一台主机可以共享使用另一台主机的硬件资源，包括计算资源（如 CPU）、储存资源、打印机与扫描仪 I/O 设备等。事实上，云计算和云储存可以提供硬件计算资源和存储资源的共享，这都是典型的硬件资源共享的实例。

- **软件资源共享**：网络上的主机可以远程访问、使用服务器计算机上运行的各类大型软件，例如，大型数据库系统、大型行业专用软件等，实现软件的共享。SaaS（Software as a Service）是目前互联网环境下软件共享的典型形式，也代表了软件共享的主流趋势。

- **信息资源共享**：目前各类信息（主要是非涉密公开信息）都是通过互联网进行发布共享的，包括政府的政策法规、企业的产品信息、社会热点新闻、高校研究成果等。计算机网络所支持的信息交换就是典型的信息共享。

#### 计算机网络的分类

1，目前最大的计算机网络就是 Internet（因特网）。按不同的分类标准可以将这些网络划分为不同的类型。

> 按覆盖范围分类

- **个域网（PAN）**：通常由个人设备通过`无线通信技术`构成的小范围网络，实现个人设备间的数据传输，比如通过蓝牙技术实现个人设备的互联等。`个域网通常覆盖范围在 1 ~ 10m`。

- **局域网（LAN）**：局域网通常部署在办公室、办公楼、厂区、校园等局部区域内，采用`高速有线或无线链路`连接主机，实现局部范围内高速数据传输。局域网通常覆盖范围在 `10m ~ 1km`。

- **城域网（MAN）**：城域网是指覆盖一个城市范围的网络，覆盖范围通常在 `5 ~ 50km`。

- **广域网（WAN）**：广域网覆盖范围在`几十到几千千米`，通常跨越更大的地理空间，可以实现异地城域网或局域网的互联。

> 按拓扑结构分类

- 网络拓扑是指网络中的主机、网络设备间的物理连接关系与布局。按拓扑结构，计算机网络可以分为`星形拓扑结构`、`总线型拓扑结构`、`环形拓扑结构`、`网状拓扑结构`、`树形拓扑结构`和`混合型拓扑结构`等。

![拓扑结构分类](topological.jpg)

1，**星形拓扑结构**：星行拓扑结构网络包括一个中央结点，网络中的主机通过点对点通信链路与中央节点连接。中央节点通常是`集线器，交换机`等设备，主机之间的通信都需要通过中央节点进行。星形拓扑结构网络比较多见于局域网、个域网中。

- **优缺点**：其主要`优点是易于监控与管理，故障诊断与隔离容易`；其主要`缺点是中央结点是网络的瓶颈，一旦故障，全网瘫痪，网络规模受限于中央节点的端口数量`。

2，**总线型拓扑结构**：总线型拓扑结构网络采用一条广播通信道作为公共传输介质，称为总线，所有节点均与总线连接，结点间的通道均通过共享的总线进行。由于总线是一条广播信道，所以任一节点通过总线发送数据时，其它节点都会收到承载这些数据的信号。`如果同时有两个或两个以上的结点同时向共享信道中发送数据，就会产生干扰，会导致任何一个结点的数据发送失败，这一现象称之为冲突`。总线型拓扑结构网络在早期的局域网中比较多见。

- **优缺点**：其主要`优点是结构简单，所需电缆数量少，易于扩展`；主要`缺点是通信范围受限，故障挣断与隔离较困难，容易产生冲突`。

3，**环形拓扑结构**：环形拓扑结构网络利用通信链路将所有结点连接成一个闭合的环，环中的数据传输通常是单向（也可以双向）传输，每个节点可以从环中接收数据，并向环中进一步转发数据。如果某节点判断数据是发送给自己的，则复制数据。数据会沿特定的方向环绕一周，回到发送数据的结点，发送数据的结点需要负责从环中清除其发送的数据，即“自生自灭”。环形拓扑结构网络多见于早期的局域网、园区网和城域网中。

- **优缺点**：其主要`优点是所需电缆长度短，可以使用光纤，易于避免冲突`；其主要`缺点是某节点的故障容易引起全网瘫痪，新节点的加入或撤出过程比较麻烦，存在等待时间问题`。

4，**网状拓扑结构**：网状拓扑结构网络中的结点通过多条链路与不同的结点直接连接，如果网状拓扑结构网络的任一结点与其余所有结点均有直接链路连接，则称为`完全网状拓扑网络`，上图所示的即为完全网状拓扑网络；否则称之为非完全网状拓扑网络。网状拓扑结构网络比较多见与广域网、核心网络等。

- **优缺点**：其主要`优点是网络可靠性高，一条或多条链路故障时，网络仍然可联通`；其主要`缺点是网络结构复杂，造价成本高，选路协议复杂`。

5，**树形拓扑结构**：树形拓扑结构网络可以看作是总线型拓扑或星形拓扑网络的`扩展`。比较多见的是通过级联星形拓扑网络中的中央结点构建树形拓扑结构网络。目前，很多局域网采用这种拓扑结构。

- **优缺点**：其主要`优点是易于扩展，故障隔离容易`；其主要`缺点是对根节点的可靠性要求高，一旦根节点故障，则可能导致网络大范围无法通信`。

6，**混合拓扑结构**：混合拓扑结构网络是由`两种以上简单拓扑结构网络`混合连接而成的网络。绝大多数实际网络的拓扑都属于混合拓扑结构，比如 Internet。

- **优缺点**：其主要`优点是易于扩展，可以构建不同规模网络，并可根据需要优选网络结构`；其主要`缺点是网络结构复杂，管理与维护复杂`。

> 按网络用户属性分类

1，按网络用户属性，计算机网络可以分为共有网和专用网。

- **公有网**：公有网指由国家或企业建设，面向公众提供收费或免费服务的网络。

- **私有网**：私有网指由某个组织（如政府部门或企业等）出资建设，专门面向该组织内部业务提供网络传输服务，不向公众开放的网络。私有网络不向组织外的人员提供服务，只用于支持组织内部业务，例如军事专用网络、航空专用网络、银行专用网络、铁路专用网络等。

### 计算机网络结构

> 计算机网络规模不同，其结构复杂程度也不同。大规模现代计算机网络的结构包括`网络边缘（network edge）`、`接入网络（access network）`、`网络核心（network core）`3 部分。

#### 网络边缘

1，连接到网络上的计算机、服务器、智能手机、智能传感器、智能家电等称为`主机`或`端系统`。这些端系统位于网络的最边缘，因此，连接到网络上的所有端系统构成了网络边缘。可以说`网络边缘为网络用户提供了网络应用服务`。

#### 接入网络

> 通常情况下，网络核心是由一些电信网络运营商等企业运营的 ISP（internet 服务提供商）网络，不能直接延伸到用户区域。例如家中，这些用户就需要借助接入网络实现与 ISP 的连接。而接入网络的作用就是能将用户与 ISP 进行连接，作为用户与 ISP 连接的介质。

1，**电话拨号接入**：该方式是利用电话网络，通过`调制解调器（modem）`将数字信号调制到模拟电话线路，通过电话网络的模拟语音信号作为载波传送到远端，再利用调制解调器将数字信号从模拟信号中解调出来。虽然这种方式覆盖广，但是其最大带宽通常为 `56 kbit/s`。

2，**非对称数字用户线路 ADSL**：ASDL 是利用现有的电话网络的用户线路实现的接入网络。ADSL 是目前家庭用户接入网络中比较常见的一种接入方式。ASDL 基于`频分多路复用（EDM）技术`实现电话语音通信与数字通信（即网络数据传输）共享一条用户线路，在进行网络通信的同时，可以进行电话语音通信，这与传统的拨号接入存在很大的差异。之所以称为`非对称`数据用户线路，是因为在 ADSL 接入网络中，在用户线路上实现的`上行（从用户端向网络上传数据）带宽比下行（从网络向用户端下传数据）带宽小`。ASDL 存在很多标准，并且可以实现的上行和下行带宽与用户线路的长度有关系，当用户线路长度在 3 ~ 5km 范围时，典型的上行带宽为 512kbit/s ~ 1Mbit/s，下行带宽为 1 ~ 8Mbit/s。当用户线路长度在 1.3km 以内时，可以实现更高速率的 VDSL，其典型的下行带宽可以达到 55 Mbit/s，上行带宽可以达到 19.2Mbit/s。

3，**混合光纤同轴电缆 HFC 接入网络**：HFC 接入网络也称为`电缆调制解调器接入`，是利用有线电视网络实现网络接入的技术。HFC 接入网络的用户端使用电缆调制解调器连接有线电视网的入户同轴电缆，同轴电缆来接到光纤结点，再通过光纤链路连接电缆调制解调器端接系统，进而连接网络，如 Internet。HFC 也是基于频分多路复用技术，也是`非对称`的。典型的上行带宽为 30.7Mbit/s，下行带宽为 42.8Mbit/s。由于 HFC 是`共享式接入`，即连接到同一段同轴电缆上（比如同一栋住宅楼内）的用户共享上行和下行带宽，这些用户需要从总的上行和下行带宽中进行平分。因此虽然 HFC 接入的上下行带宽表面看要比 ADSL 的带宽高，但是当用户数量较大时，HFC 接入没有 ASDL 接入速率快，因为 ASDL 是独享式接入。

4，**局域网**：企业、学校等机构会在组织范围内建设局域网，连接所有需要接入外部网路的主机，然后通过企业网络或校园网的边缘路由器连接网络核心。典型的局域网技术是`以太网`、`Wi-Fi`等。

5，**移动接入网络**；移动接入网络主要利用移动通信网络，如 3G/4G/5G 网络，实现智能手机、移动终端等设备的网络接入。

#### 网络核心

1，网络核心是由`通信链路互联的分组交换设备`构成的网络，`作用是实现网络边缘中主机之间数据的中继与转发`。比较典型的分组交换设备是`路由器`和`交换机`等。在大规模计算机网络中，相距遥远的主机之间不可能通过一条物理通信链路直接连接，而是各自通过接入网连接到网络核心上，彼此传输的数据都是通过网络核心进行中继和转发，最后送达目的主机。

2，对于网络核心中的每个路由器，必须能够为去往不同目的的数据做出合理的决策，选择如何转发数据，如转发给哪个相邻的路由器，通过路由器之间的转发和中继，最终将数据送达正确的目的主机。

### 数据交换技术

#### 数据交换的概念

1，数据交换是实现在大规模网络核心上进行数据传输的技术基础。常见的数据交换技术包括`电路交换`，`报文交换`，`分组交换`。基于不同交换技术构建的网络分别称之为电路交换网络、报文交换网络和分组交换网络。

![数据交换](dataExchange.jpg)

> 交换结点和传输介质的集合称之为通信子网，即网络核心。

#### 电路交换

1，电路交换是最早出现的一种交换方式，距今已有 100 多年的历史，而电话网络则是最早、最大的电路交换网络。在电路交换网络中，首先需要通过中间交换结点为两台主机之间建立一条`专用的通信线路`，称之为电路，然后再利用该电路进行通信，通行结束后在拆除电路。电话网络的电话拨号呼叫过程就是请求建立电路的过程。电路交换网络在建立电路时，为整个会话在沿线所有链路上都预留一个专用信道，传输速率恒定。利用电路交换进行通信包括`建立电路`、`传输数据`和`拆除电路` 3 个阶段。

- **建立电路**：如果两个主机之间需要进行通信，那么发送主机需要先发出呼叫请求信号给接收主机，然后经过若干个结点沿途接通一条物理链路后，再由接收主机发出应答信号给发送主机，这样双方之间的电路连接就建立成功了。只有电路建立成功之后，才能进入数据传输阶段。其中，电路交换的这种 “连接” 过程所需时间（电路建立时间）的长短与连接的中间交换结点的个数有关。

- **传输数据**：电路建立之后，被传输的数据可以是数字数据也可以是模拟数据，数据的传输可以是单工也可以是双工。在发送主机和接收主机之间存在一条 “独占” 的物理线路为双方的本次通信服务，这里 “独占” 指的是`交换结点之间的线路是相对独占`的，因为通过`信道复用技术`对一条物理信道进行信道划分；而`主机的交换结点之间的线路往往是绝对独占`的。

- **拆除电路**：数据传输结束后，要释放（拆除）该物理链路。该释放动作由两个通信主机之间任何一方发起并完成。释放的信号必须传送到电路所经过的各个结点，以便重新分配资源。

2，综上所述，电路交换的特点是：有连接的，在通信时需要先建立电路连接，在通信过程中独占一个信道，通信结束后拆除电路连接。

3，电路交换的优点是：`实时性高`，延时和时延抖动都较小；缺点是：对于突发性的数据传输，`信道利用率低`，且传输速率单一。

4，电路交换主要适用于语音和视频这类实时性强的业务。

#### 报文交换

1，报文交换也称为信息交换，其工作过程为：发送方把要发送的信息附加上发送/接收主机的地址及其他控制信息，构成一个完整的报文。然后以报文为单位在交换网络的各结点之间以储存-转发的方式传送，直至送达目的主机。

- 一个报文在每个结点的延时时间，等于接收报文所需的时间加上向下一个结点转发所需要的排队延时时间之和。

2，报文交换事先`不需要建立连接`，发送方组装好报文之后即可向相邻的交换结点发出，交换结点收到整个报文并且检查无误后，暂时储存报文，然后利用`路由`选择找出需要转发的下一个结点的地址，再把整个报文传发给下一个结点。

3，交换节点这种接收-暂存-转发的工作方式，就称为：“存储-转发” 交换方式。只有当报文被转发时才占用相应的信道，不存在电路交换中通信双方空闲时信道也被占用的情况。因此相对电路交换信道而言，`报文交换线路利用率高`。

4，由于报文交换网络中交换节点需要缓冲存储，报文需要排队，因此会导致报文经过网络的延迟时间变长且不固定，对于`实时通信而言会容易出现不能满足速度的要求`。有时候结点收到的报文过多而`存储空间不够`或者`输出链路被占用不能及时转发时`，就不得不`丢弃报文`，这也是报文交换的缺点。

#### 分组交换

1，**分组交换的基本原理**：分组交换是目前计算机网络广泛采用的技术。

- 分组交换需要将待传输数据（即报文）分割成较小的数据块，每个数据块附加上`地址`、`序号`等控制信息构成`数据分组`（packet），每个分组独立传输到目的地，目的地将受到的分组重新组装，还原报文。

- 分组传输过程通常也采用存储-转发交换方式。

- 分组交换是报文交换的一种改进，它将一个完整报文拆分成若干个分组，每个分组的长度有一个上限，有限长度的分组使得每个节点所需的`存储能力降低`，分组可以存储到内存中，提高了交换速度。

![分组交换](packetSwitching.png)

> 上图中第 1 个分组已经到达目的端，第 2 个和第 3 个分组正在网络中传送，最后一个分组仍然在源主机。

2，**分组交换的优点**：分组交换与报文交换相比，两者都采用存储-转发交换方式，最主要的区别在于是否将报文拆分为更小的分组。与报文交换相比，分组交换主要有如下优点：

- `交换设备存储容量要求低`：分组交换将大报文拆分为较短的分组进行传输。理论上而言，分组设备只要能缓存一个小分组，网络就可以工作。因此，分组交换可以大大降低对网络交换结点的存储容量的要求。

- `交换速度块`：分组交换设备由于只需要缓存一定数量的较短的分组，因此可以利用主存储器进行存储-转发处理，不需要访问外存，处理转发速度加快。另外，在分组交换网络中，`多个分组可以在网络中的不同链路上进行并发传送`，大大提高传输效率和线路利用率，大幅缩短整个报文通过网络的时间。

- `可靠传输效率高`：对于交换网络，一个分组出现差错，只需要重传出错的分组，并不需要重传所有由同一报文拆分出来的所有分组。对比报文传输而言，重传一个分组的代价远远小于重传整个报文的代价，因为报文传输出错需要重传整个报文。

- `更加公平`：对于分组交换，如果交换分组大小相同，那么大报文将拆分出更多的分组，小报文将拆分出较少的分组，不同报文的分组在交换结点上可能`交替排队`，每个分组通过网络的时间相当，总体上，小报文将用较短时间通过网络到达目的。

3，**分组长度的确定**：分组长度的选择与交换过程中的延迟时间、交换设备存储容量、线路利用率、信道传输质量、数据业务统计特性以及交换机费用等诸多因素有关。

- 分组长度与延时：分组长度与交换过程的延迟时间关系可以利用排队论进行分析。分组交换网络的存储-转发过程可以抽象为一个排队系统，基于排队系统的分析发现，`当分组具有相同的长度时，分组在交换过程中的延迟时间较小`。而在其它条件相同的情况下，`分组长度越长，延迟时间越长`。对于实时交互式通信，要求延迟时间短，分组长度应该尽可能短，对于诸如文件传送类的非实时数据通信，延迟要求不高，即使分组长度较长，也不至于影响正常通信，分组长度可以适当长些。但`分组长度不宜太短`，因为分组长度太短，就意味着一个报文需要拆分的分组输增加 ，而每个分组是需要`附加控制信息`的，`额外开销会增加`，`有效数据传输效率会降低`，因此需要在延迟时间与开销之间进行平衡。实际的分组交换网络的分组长度并不总是相同的，通常会规定一个分组长度范围，这样既具有灵活性，又尽可能优化网络延时。

- 分组长度与误码率：通信链路的信道误码率是确定分组长度时另一个需要重要考虑的因素。

- 综上所述，目前国际电信联盟以建议的形式制定出，分组长度以 16B（1B = 8bit）到 4096B 之间的 2<sup>n</sup>B 为标准分组长度，例如：32B、64B、256B、512B 和 1024B 等。

### 计算机网络性能

#### 速率与带宽

1，速率是计算机网络中最重要的性能指标之一。速率是指网络单位时间内传送的数据量，用以描述网络传输数据的快慢，也称为`数据传输速率`或`数据速率`。

- 计算机网络传输的数据是以位位信息单位的二进制数据，速率的基本单位是 bit/s，因此有时也称速率为比特率（bit rate）。

2，在计算机网络中，有时也会用`带宽`这一术语描述速率。在通信或信号处理领域中，带宽原本是指信号具有的频带宽度，即信号成分的`最高频率与最低频率之差`，单位为赫兹（Hz）。

- 在计算机网络中，当描述一条链路或信道的数据传输能力时，经常使用`带宽`一词表示链路或信道的最高数据速率，单位也是 bit/s。

#### 时延

1，时延（delay）是评价计算机网络性能的另一个重要的性能指标，也称为延迟。

- 时延是指数据从网络中的一个结点（主机或交换设备等）到达另一结点所需要的时间。

- 计算机网络中，通常将连接两个结点的直接链路称为一个 "跳步"，简称 "跳"。

- 在存储-转发方式的分组交换网络中，只要分析清楚分组在每一跳过程的时延，就可以求得任意情况下，分组从源节点到达目的的结点的时延。

- 分组的每跳传输过程主要产生 4 类时间延迟：`结点处理时延`、`排队时延`、`传输时延`和`传播时延`。

![分组在每跳传输过程中的 4 类时延](delay.png)

2，结点处理时延：每个分组到达交换结点（比如路由器）时，交换设备通常可能需要验证分组是否有差错，根据分组携带的信息（比如目的地址）检索转发表，确定如何转发该分组，还有可能修改分组的部分控制信息等。针对分组进行这些操作所消耗的时间总和，构成了结点处理时延，记为：d<sub>c°</sub>

- 结点处理时延通常很小，并且对不同分组的结点处理时延变化也非常小，因此，在谈论网络总时间延迟时 常常被忽略。

3，排队时延：当一个分组到达交换节点，经过处理并明确需要从哪个输出链路进行转发后，`分组需要在交换节点内被交换到输出链路`，等待从输出链路发送到下一个交换节点（或目的主机）。

- 在该分组之前很有可能还有其他分组正在或等待交换到相同的输出链路，或者交换到输出链路后在该分组之前还有其他分组在等待通过输出链路进行发送。`这些情形都需要分组在交换结点进行暂时缓存`（这也是存储-转发概念的由来），排队等待输出链路可用，分组在缓存中排队等待的时间就是排队时延，记为：d<sub>q°</sub>

4，传输时延：当一个分组在输出链路发送时，从发送第一位开始，到发送完最后一位为止，所用的时间，称为传输时延，记为：d<sub>t°</sub>。

- 假设分组长度为 Lbit，链路带宽（即速率）为 Rbit/s，则分组的传输时延为：**d<sub>t</sub> = L/R**。

5，传播时延：信号从发送端发送出来，经过一定距离的物理链路到达接收端所需要的时间，称为传播时延。记为：d<sub>p°</sub>。

- 若物理链路长度为 D（m），信号传播速度为 V（m/s），则传播时延为：**d<sub>p</sub> = D/V**。

> 综上所述，一个分组经过一个跳步所需时间为：d<sub>h</sub> = d<sub>c</sub> + d<sub>q</sub> + d<sub>t</sub> + d<sub>p</sub>。假设从源主机到达目的主机需要经过 n 个交换结点，那么经过的跳步数就为 (n + 1)。

#### 时延带宽积

1，一段物理链路的`传播时延`与`链路带宽`的`乘积`，称为时延带宽积，记为 G，于是 **G = d<sub>p</sub> × R**，等价于 **D/V × R**。

- 时延带宽积 G 的单位是`位`。

- 时延带宽积的物理意义在于：如果将物理链路看作一个传输数据的管道的话，`时延带宽积表示一段链路可以容纳的数据位数`，也称为以位为单位的链路长度。

> 通俗的讲，传播时延就相当于从 A 到 B 所需要的时间，而链路带宽就相当于一段链路的宽度，那么时延带宽积就相当于经过这段链路所需的时间乘以这段链路的宽度，即为这段链路可以容纳的数据位数。

#### 丢包率

1，当网络拥塞特别严重时，新到达的分组甚至已无缓存空间暂存该分组，此时交换结点会丢弃分组，也就产生了`丢包`现象。

- 说明：由于排队时延的大小取决于网络拥塞程度，网络拥塞越严重，平均排队时延就越长，所消耗的储存空间就越大（因为处在排队的分组需要交换结点进行暂存），否则与之相反。

2，丢包率常被用于评价和衡量网络性能的指标，在很大程度上可以反映网络的拥塞程度，因为引发网络丢包的主要因素是网络拥塞。

- 丢包率可以定义为：**η = N<sub>l</sub>/N<sub>s</sub> = (N<sub>s</sub> - N<sub>r</sub>)/N<sub>s</sub>**。式中，N<sub>s</sub>为分组总数，N<sub>r</sub>为接收分组总数，N<sub>l</sub>为丢失分组总数。

#### 五、吞吐量

1，吞吐量表示在单位时间内源主机通过网络向目的主机实际送达的数据量，单位为 bit/s 或 B/s（字节每秒），记为 Thr。

- 吞吐量经常用于度量网络的实际数据传送（通过）能力，即网络实际可以到达的从源主机到目的主机的`数据传送速率`。

> 为什么吞吐量能表示数据传送速率，因为在单位时间内，从 A 到 B 的这段网络链路总共传输了 x 这么多的数据量，那么数据总量除以单位时间就是传输的速率了。

- 吞吐量受网络`链路带宽`、`网络连接复杂性`、`网络协议`、`网络拥塞程度`等因素影响。

2，对于`分组交换网络`，源主机到目的主机的`吞吐量`在理想情况下`约等于瓶颈链路的带宽`。

- Thr = min(R<sub>1</sub> , R<sub>2</sub> , ... , R<sub>i</sub> , R<sub>N-1</sub> , R<sub>N</sub>)。

![吞吐量与瓶颈链路示意图](tuntuliang.jpg)

- 如果能`确定`两个主机之间的`吞吐量`，则可以利用吞吐量来`计算`从一个主机向另一个主机`发送`一定量`数据所需要的时间`。

### 计算机网络体系结构

#### 计算机网络分层体系结构

1，制定网络协议最典型的划分方式就是采用`分层的方式`来组织协议。分层的核心思路是上一层的功能建立在下一层的功能基础上，并且在每一层内均要遵守一定的通信规则，即协议。

2，按照分层的思想，计算机网络完成的所有功能可以划分为若干层，每层完成一部分子功能，每层在完成相应功能时与另一通信实体的`相同层`按照某种`协议`进行`信息交换`。这样，计算机网络所划分的`层次`以及`各层协议的集合`称之为`计算机网络体系结构`。

- 体系结构应当具有足够的信息，以便软件设计人员为每层编写实现该层协议的有关程序，即`协议软件`。需要注意的是，这种分层体系结构通常`是按功能划分`的，并`不是按实现方式划分`的。

- 目前，典型的层次化体系结构有 `OSI` 参考模型和 `TCP/IP` 参考模型。

#### OSI 参考模型

> OSI 参考模型总称为：开放系统互联参考模型（Open System Interconnection），而按照这个标准设计建成的计算机网络中的设备都可以相互通信。

- OSI 参考模型采用分层结构化技术，将整个计算机网络的通信功能分为 `7 层`，由低层至高层分别是：`物理层`、`数据链路层`、`网络层`、`传输层`、`会话层`、`表示层`、`应用层`。每一层都有特定的功能，并且上一层利用下一层的功能所提出的服务，完成本层功能。

![OSI七层协议](osi.jpg)

![OSI参考模型描述的数据封装与传输过程](7.png)

![OSI参考模型数据传输过程](osi7.png)

##### OSI 七层协议介绍

<1>，**物理层**：物理层主要功能是`在传输介质上实现无结构比特流传输`。所谓无结构比特流是指不关心比特流实际代表的信息内容，只关心如何将 0 和 1 这些比特以合适的信号传送到目的地，因此，`物理层要实现型号编码功能`。

- 物理层的另一项主要任务就是`规定数据终端设备（DTE）与数据通信设备（DCE）之间接口的相关特性`，主要包括机械、电气、功能和规程 4 个方面的特性。

- 机械特性也叫物理特性，说明硬件连接接口的机械特点，导线的电气连接及有关电路的特性，如信号的电平大小、接收器和发送器特性的说明、信号的识别、最大传输速率的说明等。

- 功能特性说明物理接口个条信号线的用途，如接口信号线的功能分类等。

- 规程特性指明利用接口传输比特流的全过程及各项用于传输的事件发生的合法顺序，包括事件的执行顺序和数据传输方式，即在物理连接建立、维持和交换信息时，收发双方在各自电路上的动作序列。

- 以上这些功能都是由物理层的协议来完成的。

<2>，**数据链路层**：该层的主要功能是实现在相邻结点之间`数据可靠而有效的传输`。

- 数据在物理介质内传输过程。不能保证没有任何错误发生，为了能实现有效的差错控制，就采用了一种以`帧`为单位的数据块传输方式。要采用帧格式传输，就必须有相应的帧同步技术，这就是数据链路层的`成帧`（也称为帧同步）功能，包括帧的格式、类型、成帧的方法等。

- 数据链路层还可以实现相邻结点间通信的`流量控制`。

- 某些数据通信网络的数据链路层还提供`连接管理`功能，即通信前建立数据链路，通信结束后释放数据链路，这种数据链路的建立、维持和释放过程称为链路管理。

- 数据链路层还有一个重要的功能是`寻址`，即用来确保每一帧都能准确地传送到正确的接收方，接收方也应该知道发送方的地址，这在使用广播介质的网路中尤为重要，比如计算机局域网中广泛采用 MAC 地址。

<3>，**网络层**：网络层解决的核心问题是如何将分组通过交换网络传送至目的主机，因此，`网络层的主要功能是数据转发与路由`。

- 一个包含源节点、中继结点、目的节点的集合称为从源节点到目的节点的路径。

- 一般在两个结点之间都会有多条路径选择，这种路由选择是网络层要完成的主要功能之一。

<4>，**传输层**：传输层是第一个端到端的层次，也是进程到进程的层次。

- 数据通信表面上是在两个主机之间进行，但实质上是发生在两个主机的进程之间。

- 传输层的`功能主要包括`：复用/分解（区分发送和接收主机上的进程）、端到端的可靠数据传输、连接控制、流量控制和拥塞控制机制等。

<5>，**会话层**：会话层是指用户与用户的连接，通过在两台计算机间建立、管理和终止通信来完成对话。

- 会话层主要功能为：在建立会话时`核实双方身份`是否有权参加会话，确定双方支付通信费用；双方在各种选择功能方面（如双工还是半双工通信）取得一致；

- 在实际的网络中、会话层的功能已经被应用层所覆盖，很少单独存在。

<6>，**表示层**：表示层主要用于`处理`运用实体间交换数据的`语法`，其目的是`解决格式和数据表示的差别`，从而为应用层提供一个一致的数据格式，使字符、格式等有差异的设备之间相互通信。

- 表示层还可以实现文本压缩/解压缩，数据加密/解密、字符编码的转换等功能。

- 表示层的功能在某些实际数据通信网络中是由应用层来实现的，而且表示层不独立存在。

<7>，**应用层**：应用层与提供给用户的网络服务相关，它为用户提供了一个使用网络应用的 "接口"。

> OSI 参考模型的 7 层中，1 ~ 3 层主要是完成数据交换和数据传输，称之为网络低层；5 ~ 7 层主要是完成信息处理服务的功能，称之为网络高层，底层与高层之间由第 4 层衔接。

##### OSI 参考模型有关术语

> OSI 参考模型中每一层的真正功能是为其上一层提供服务。例如：N 层的实体为（N + 1）层的实体提供服务。N 层的服务则需要使用（N - 1）层以及更低层提供的功能服务。

<1>，数据单元：在层的实体之间传送的`比特组`称为`数据单元`。在对等层之间传送数据单元是按照本层协议进行的，因此，这时的数据单元称之为协议数据单元（PDU）。

![层间数据单元的传送](PDU.png)

- 上图显示出了层间数据单元的传送过程，其中 PDU 是协议数据单元，SDU 是服务数据单元，PCI 是协议控制信息，通常作为 PDU 的首部。

- 到达目的站的 N-PDU，在送往（N+1）层之前要把 N-PCI 去掉。

- 在层间通信中 PCI 相当于报头，即首部，如上图所示。

- 在源点点逐层增加新的 PCI，到达目的地之后则逐级去掉，使得信息原来的结构得以恢复。

- PDU 在不同层往往有不同的叫法，如在`物理层`称之为`流或比特流`，在`数据链路层`称之为`帧`，在`网络层`中称之为`分组或包`，在`传输层`称之为`数据段或报文段`，在`应用层`称之为`报文`等。

<2>，服务访问点：相邻层间的服务是通过其接口面上的服务访问点（Service Access Point，SAP）进行的，N 层 SAP 就是（N+1）层可以访问 N 层的地方。

- 每个 SAP 都有一个唯一的地址号码。

<3>，服务原语：第 N 层向（N+1）层提供服务，或第（N+1）层请求 N 层提供服务，都是一组原语（Primitive）描述的。OSI 参考模型的原语有 4 类，分别如下：

- 请求（Request）：用户实体请求服务做某种工作。

- 指示（Indication）：用户实体被告知某件事情发生。

- 响应（Pesponse）：用户实体表示对某件事的响应。

- 证实（Confirm）：用户实体收到关于它的请求的答复。

<4>，面向连接的服务和无连接的服务：在分层的体系结构中，下层向上层提供服务通常有两种形式：面向连接的服务和无连接的服务。

- 面向连接的服务以电话系统最为典型。当需要传送数据时，需要建立连接，连接成功后在进行数据传送，最后数据传送结束后，拆除链路。

- 无连接的服务没有建立连接和拆除链路的过程。无连接的服务又称为数据报服务，要求每一个分组信息带有全称地址，独立选择路径，其到达目的地的顺序也是不一定的，到达目的地后，还有重新对分组进行排序。

#### TCP/IP 参考模型

##### TCP/IP 参考模型简介

- TCP/IP 参考模型包括 4 层，通常每一层封装的数据包采用不同的名称，如下图所示：

![TCP/IP参考模型](TCP.png)

![TCP/IP参考模型](TCPIP.png)

##### TCP/IP 各层级介绍

<1>，**应用层**：TCP/IP 参考模型将 OSI 参考模型中会话层和表示层的功能合并到应用层来实现。

- 在 Internet 上常见的一些网络应用大多在这一层，用户通过应用层来使用 Internet 提供的各种网络服务，例如：www 服务、文件传输、电子邮件等。

- 每一种应用都使用了相应的协议来将用户的数据（网页、文件、电子邮件等）按照协议定义的格式进行封装，以便达到对应的控制功能，然后再利用下一层即传输层的协议进行传输，例如，`www` 服务的应用层协议为 `HTTP`、`文件传输`的应用层协议是 `FTP`、`电子邮件`应用层协议包括 `SMTP` 和 `POP3` 等。

- 每一个应用层协议一般都会使用到两个传输层协议之一进行数据传输：面向连接的传输控制协议 TCP 和无连接的用户数据报协议 UDP。

<2>，**传输层**：当应用层的程序将用户数据按照特定应用层协议封装好后，接下来就由传输层的协议负责把这些数据传输到接收方主机上对等的应用层程序。

- 传输层协议可以解决（如果需要）诸如端到端可靠性，保证数据按照正确的顺序到达等问题。

- 传输层负责在网络层和网络互联层之间传递消息，丝毫不会涉及信息如何在网络中传输，而是交给下面的网络互联层去解决。

- TCP/IP 参考模型的传输层主要包括：`面向连接`、提供可靠数据流传输的`传输控制协议 TCP` 和`无连接`、不提供可靠数据流传输的`用户数据报协议 UDP`。

<3>，**网络互联层**：网络互联层是整个 TCP/IP 参考模型的核心，主要解决把数据分组发往目的网络或主机的问题。在这个过程中，要为分组的传输选择相应的路径（路由选择），完成分组的转发，提供网络层寻址————IP 地址。

- 网络互联层除了需要完成路由的功能外，也可以完成将不同类型的网络（异构网）进行互连的任务。

- 在 TCP/IP 参考模型中，`网络互联层的核心协议是 IP`，负责定义分组的格式和传输。`IP 是无连接不可靠网络协议`，因此，IP 分组到达的顺序和发送的顺序可能不同，并且可能存在分组丢失的现象。

- 网络互联层还包括`互联网控制报文协议 ICMP`、互联网多播组管理协议 `IGMP` 以及路由协议，如 BGP、OSPF、RIP 等。

<4>，**网络接口层**：这一层对应 OSI 参考模型中的`数据链路层`和`物理层`，网络层 IP 分组在这一层被封装到底层网络的链路层数据帧中，并最终以比特流的形式在物理介质上进行传输。

- 在 TCP/IP 参考模型中，没有真正描述这一层的实现，只是要求能够提供给其上层————网络互联层一个访问接口，以便在其上传递 IP 分组。

#### 五层参考模型

##### 五层参考模型介绍

- 结合 TCP/IP 参考模型和 OSI 参考模型，提出了综合理论需求与实际网络的五层参考模型，包括物理层、数据链路层、网络层、传输层与应用层，各层功能基本与 OSI 参考模型对应。

![五层参考模型的数据封装与传输示意图](5.png)

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>单例模式</title>
  </head>
  <body>
    <script>
      class SingMode {
        constructor(name, address) {
          if (!SingMode.instance) {
            this.name = name;
            this.address = address;
            SingMode.instance = this;
          }
          return SingMode.instance;
        }

        setAge(age) {
          this.age = age;
        }

        toString() {
          console.log(`the name is ${this.name}.`);
          console.log(`the address is ${this.address}.`);
          console.log(`the age is ${this.age}.`);
        }

        static getInstance(name, address) {
          if (!this.instance) {
            return (this.instance = new SingMode(name, address));
          }
          return this.instance;
        }
      }

      let sing1 = SingMode.getInstance("dnhyxc", "hz");
      let sing2 = SingMode.getInstance("snsn", "zx");
      let sing3 = new SingMode("yhyh", 18);
      let sing4 = new SingMode("hmhm", 26);

      console.log(sing1 === sing2); // true
      console.log(sing2 === sing3); // true
      console.log(sing3 === sing4); // true

      console.log(sing1, "sing1"); // SingMode {name: 'dnhyxc', age: 'hz'}
      console.log(sing2, "sing2"); // SingMode {name: 'dnhyxc', age: 'hz'}
      console.log(sing3, "sing3"); // SingMode {name: 'dnhyxc', age: 'hz'}
      console.log(sing4, "sing4"); // SingMode {name: 'dnhyxc', age: 'hz'}

      sing1.setAge(18);
      console.log(sing1); // SingMode {name: 'dnhyxc', address: 'hz', age: 18}
      sing2.setAge(26);
      console.log(sing1, "sing1"); // SingMode {name: 'dnhyxc', address: 'hz', age: 26} 'sing1'
      console.log(sing2, "sing2"); // SingMode {name: 'dnhyxc', address: 'hz', age: 26} 'sing2'

      sing1.toString();
      /*
        the name is dnhyxc.
        the address is hz.
        the age is 26.
      */

      sing2.toString();
      /*
        the name is dnhyxc.
        the address is hz.
        the age is 26.
      */

      function Sing(name, age) {
        let instance = null;

        if (!Sing.instance) {
          this.name = name;
          this.age = age;
          Sing.instance = this;
        } else {
          return Sing.instance;
        }
      }

      const single1 = new Sing("snsn", 18);
      const single2 = new Sing("hmhm", 28);

      console.log(single1);
      console.log(single2);
      console.log(Sing.instance);

      // 通过闭包实现
      const singleMedo = (function (name, age) {
        let instance = null;

        function Sing(name, age) {
          this.name = name;
          this.age = age;
        }

        if (!instance) {
          instance = new Sing(name, age);
        }

        return function () {
          return instance;
        };
      })("shsh", 18);

      const singleMedo1 = singleMedo();
      const singleMedo2 = singleMedo();
      console.log(singleMedo1, "singleMedo1");
      console.log(singleMedo2, "singleMedo2");
    </script>
  </body>
</html>
